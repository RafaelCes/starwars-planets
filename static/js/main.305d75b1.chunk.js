(this["webpackJsonpsd-0x-project-react-context-hooks-starwars-datatable-filters"]=this["webpackJsonpsd-0x-project-react-context-hooks-starwars-datatable-filters"]||[]).push([[0],{11:function(e,t,n){e.exports=n(18)},16:function(e,t,n){},18:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(9),c=n.n(l),u=(n(16),n(1)),i=Object(a.createContext)();function o(){var e=Object(a.useContext)(i),t=e.filters,n=e.setFilters,l=e.data,c=e.setFilterByName,o=e.applyFilters,m=e.columnFilterOptions,s=e.newFilter,f=e.handleChangeNewFilter,d=e.setFilterByNumericValues,p=e.removeFilterByNumericValues,b=e.newOrder,E=e.setNewOrder,O=t.filterByName.name,v=t.filterByNumericValues,j=s.column,h=s.comparison,y=s.value;Object(a.useEffect)((function(){o()}),[t]);return r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"search-input"},"Pesquisa:",r.a.createElement("input",{type:"text","data-testid":"name-filter",id:"search-input",value:O,onChange:function(e){return c(e.target.value)}})),r.a.createElement("label",{htmlFor:"column-filter"},r.a.createElement("select",{"data-testid":"column-filter",name:"column",id:"column-filter",value:j,onChange:f},m.map((function(e){return r.a.createElement("option",{key:e},e)})))),r.a.createElement("label",{htmlFor:"comparison-filter"},r.a.createElement("select",{"data-testid":"comparison-filter",name:"comparison",id:"comparison-filter",value:h,onChange:f},r.a.createElement("option",null,"maior que"),r.a.createElement("option",null,"menor que"),r.a.createElement("option",null,"igual a"))),r.a.createElement("label",{htmlFor:"value-filter"},"valor:",r.a.createElement("input",{type:"number","data-testid":"value-filter",name:"value",id:"value-filter",value:y,onChange:f})),r.a.createElement("button",{type:"button","data-testid":"button-filter",onClick:d},"Adicionar filtro"),r.a.createElement("select",{"data-testid":"column-sort",value:b.column,onChange:function(e){return E(Object(u.a)(Object(u.a)({},b),{},{column:e.target.value}))}},l.length?Object.keys(l[0]).map((function(e){return r.a.createElement("option",{key:e},e)})):""),r.a.createElement("label",{htmlFor:"asc"},"ascendente:",r.a.createElement("input",{type:"radio",id:"asc",name:"sort","data-testid":"column-sort-input-asc",value:"ASC",checked:"ASC"===b.sort,onChange:function(){return E(Object(u.a)(Object(u.a)({},b),{},{sort:"ASC"}))}})),r.a.createElement("label",{htmlFor:"desc"},"Descendente:",r.a.createElement("input",{type:"radio",id:"desc",name:"sort","data-testid":"column-sort-input-desc",value:"DESC",checked:"DESC"===b.sort,onChange:function(){return E(Object(u.a)(Object(u.a)({},b),{},{sort:"DESC"}))}})),r.a.createElement("button",{type:"button","data-testid":"column-sort-button",onClick:function(){return n(Object(u.a)(Object(u.a)({},t),{},{order:b}))}},"Ordenar"),v.map((function(e){return r.a.createElement("div",{key:e.column,"data-testid":"filter"},r.a.createElement("p",null,e.column," ",e.comparison," ",e.value),r.a.createElement("button",{type:"button",onClick:function(){return p(e.column)}},"X"))})))}var m=n(7),s=n(4),f=n(2),d=["population","orbital_period","diameter","rotation_period","surface_water"];var p=function(e){var t=e.children,n=Object(a.useState)([]),l=Object(f.a)(n,2),c=l[0],o=l[1],p=Object(a.useState)(c),b=Object(f.a)(p,2),E=b[0],O=b[1],v=Object(a.useState)(d),j=Object(f.a)(v,2),h=j[0],y=j[1],C=Object(a.useState)({column:"name",sort:"ASC"}),F=Object(f.a)(C,2),N=F[0],g=F[1],k=Object(a.useState)({column:h[0],comparison:"maior que",value:0}),w=Object(f.a)(k,2),B=w[0],S=w[1],x=Object(a.useState)({filterByName:{name:""},filterByNumericValues:[],order:{column:"name",sort:"ASC"}}),V=Object(f.a)(x,2),D=V[0],q=V[1];Object(a.useEffect)((function(){S({column:h[0],comparison:"maior que",value:0})}),[h]);var A={data:c,fetchData:function(){return fetch("https://swapi-trybe.herokuapp.com/api/planets/").then((function(e){return e.json()})).then((function(e){return o(e.results.map((function(e){return delete e.residents,e})))})).catch((function(e){return e}))},filters:D,setFilters:q,setFilterByName:function(e){q((function(t){return Object(u.a)(Object(u.a)({},t),{},{filterByName:{name:e}})}))},filteredData:E,setFilteredData:O,applyFilters:function(){var e=c.filter((function(e){return e.name.includes(D.filterByName.name)}));e=function(e){var t=D.order,n=t.column,a=t.sort;return e.sort((function(e,t){return"ASC"===a?e[n].localeCompare(t[n],void 0,{numeric:!0,sensitivity:"base"}):t[n].localeCompare(e[n],void 0,{numeric:!0,sensitivity:"base"})}))}(e=function(e){return e=D.filterByNumericValues.reduce((function(e,t){var n=t.column,a=t.comparison,r=t.value;switch(a){case"maior que":return e.filter((function(e){return parseInt(e[n],10)>parseInt(r,10)}));case"menor que":return e.filter((function(e){return parseInt(e[n],10)<parseInt(r,10)}));case"igual a":return e.filter((function(e){return parseInt(e[n],10)===parseInt(r,10)}));default:return e}}),e)}(e)),O(e)},columnFilterOptions:h,newFilter:B,handleChangeNewFilter:function(e){var t=e.target,n=t.name,a=t.value;S((function(e){return Object(u.a)(Object(u.a)({},e),{},Object(s.a)({},n,a))}))},setFilterByNumericValues:function(){q((function(e){return Object(u.a)(Object(u.a)({},e),{},{filterByNumericValues:[].concat(Object(m.a)(e.filterByNumericValues),[B])})})),y(h.filter((function(e){return e!==B.column})))},removeFilterByNumericValues:function(e){q((function(t){return Object(u.a)(Object(u.a)({},t),{},{filterByNumericValues:t.filterByNumericValues.filter((function(t){return e!==t.column}))})})),y((function(t){return[e].concat(Object(m.a)(t))}))},newOrder:N,setNewOrder:g};return r.a.createElement(i.Provider,{value:A},t)},b=n(6),E=n.n(b),O=n(10);function v(){var e=Object(a.useContext)(i),t=e.filteredData,n=e.fetchData,l=e.data,c=e.setFilteredData,u=e.applyFilters;Object(a.useEffect)((function(){(function(){var e=Object(O.a)(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(a.useEffect)((function(){c(l),u()}),[l]);return t.length?r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,Object.keys(l[0]).map((function(e){return r.a.createElement("th",{key:e},e)})))),r.a.createElement("tbody",null,t.map((function(e){return r.a.createElement("tr",{key:e.name},r.a.createElement("td",{"data-testid":"planet-name"},e.name),r.a.createElement("td",null,e.rotation_period),r.a.createElement("td",null,e.orbital_period),r.a.createElement("td",null,e.diameter),r.a.createElement("td",null,e.climate),r.a.createElement("td",null,e.gravity),r.a.createElement("td",null,e.terrain),r.a.createElement("td",null,e.surface_water),r.a.createElement("td",null,e.population),r.a.createElement("td",null,e.films),r.a.createElement("td",null,e.created),r.a.createElement("td",null,e.edited),r.a.createElement("td",null,e.url))})))):r.a.createElement("h1",null,"Loading")}var j=function(){return r.a.createElement(p,null,r.a.createElement(o,null),r.a.createElement(v,null))};c.a.render(r.a.createElement(j,null),document.getElementById("root"))}},[[11,1,2]]]);
//# sourceMappingURL=main.305d75b1.chunk.js.map